<!doctype html>
<head>



























<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
  
  
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>

 <script>
    document.addEventListener("DOMContentLoaded", function(){
    var tex = document.querySelectorAll('script[type^="math/tex"]');

	for(var i = 0; i < tex.length; ++i)
	    {
		var display = tex[i].getAttribute('type').indexOf('mode=display') > -1;
		
		var math = tex[i].previousSibling;
		math.className = 'katex-render';
		
		var content = tex[i].textContent;
		
		katex.render(content, math, {
		    /* output: html, */
		    displayMode: display,
		    throwOnError: false,
		    trust: true
		});
		
		tex[i].parentNode.removeChild(tex[i]);
		
	    }
    });
  </script>


<script src="js/sidebar.js"></script>




<script async defer src="https://hypothes.is/embed.js"></script>


<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

<script>
  window.MathJax = 1 /* Disable MathJax */
  sagecell.makeSagecell({
  inputLocation: ".sage",
  evalButtonText: "Compute",
  languages : ["sage", "python"],
  hide : ["permalink"] 
  });
</script>



<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<script src="js/openclosebuttons.js"></script>




<link rel="stylesheet" type="text/css" href="css/iLaTeXen.css">

<script defer src="js/quiz.js"></script>

<script defer src="js/orderquiz.js"></script>
 



</head>
<body><div class="sidenav normalwidth"><button style="border:none; background-color: Transparent;" onclick="showhidemenu()" title="Toggle toc"><span style="font-size: 30px;">&#9776;</span></button><button class="openbs" title="Open buttons">+</button><button class="closebs" title="Close buttons">-</button><ul class="leftmenu" style="display: none;"><li><a class="kap" href="intro.html#7a977ed6-1bf8-499c-b7fc-506c35756c5e"><b>1</b> The language of mathematics</a></li><a href="#kap1" data-toggle="collapse"><span class="downtick">&#10095</span></a><ul id="kap1" class="collapse"><li><a href="intro.html#ff7143e4-cd82-4d70-9ed5-2479680bf96a">1.1 Computer algebra</a></li><li><a href="intro.html#39de153f-aa5e-4b65-9ed2-d14e6d319376">1.2 Objects or elements and the symbols <span class="math"></span><script type="math/tex">=</script> and <span class="math"></span><script type="math/tex">\neq</script></a></li><li><a href="intro.html#6d75d6a4-df56-4418-9e4e-6a6a4b686ea0">1.3 Sets</a></li><li><a href="intro.html#6840d0bf-1199-4802-81ce-b10388939d82">1.4 Ordering numbers</a></li><li><a href="intro.html#890c2aa3-4cb2-43fc-aec7-c38196270893">1.5 Propositional logic</a></li><li><a href="intro.html#14bd838c-3f52-4f1e-b242-0d437c9222e2">1.6 What is a mathematical proof?</a></li><li><a href="intro.html#1a4701cf-eb99-4da4-86d1-3072db2fdc87">1.7 The concept of a function</a></li></ul><li><a class="kap" href="lineqs.html#6080b7d7-9dae-4421-bf75-dc2ee04432d9"><b>2</b> Linear equations</a></li><a href="#kap2" data-toggle="collapse"><span class="downtick">&#10095</span></a><ul id="kap2" class="collapse"><li><a href="lineqs.html#6a7dde4b-d4b2-4e24-85f5-fa85cdd246c8">2.1 One linear equation with one unknown</a></li><li><a href="lineqs.html#5d725c6c-5ab6-404c-be38-b7941c0c131f">2.2 Several linear equations with several unknowns</a></li><li><a href="lineqs.html#f72100cb-475f-4e9c-9d80-d5bf44184aaf">2.3 Gauss elimination</a></li><li><a href="lineqs.html#c634b806-2ed8-4e90-bbc0-74fd5d06f66c">2.4 Polynomials</a></li><li><a href="lineqs.html#5961c502-8b65-46d3-a0c8-7a7bc5a0d038">2.5 Applications to polynomials</a></li><li><a href="lineqs.html#ff2faea1-ff75-429b-9359-c3b0f606fcb3">2.6 Shamir secret sharing</a></li><li><a href="lineqs.html#d38dc3a6-f5ad-4878-84ab-288033cc61d1">2.7 Fitting data</a></li></ul><li><a class="kap" href="matrices.html#ac78de01-faf4-4003-a06d-93bd0a049be0"><b>3</b> Matrices</a></li><a href="#kap3" data-toggle="collapse"><span class="downtick">&#10095</span></a><ul id="kap3" class="collapse"><li><a href="matrices.html#4852f3d9-8469-484e-b7ad-fd763bb22be8">3.1 Matrices</a></li><li><a href="matrices.html#ed992999-6b80-44f7-9d04-5d6a54a786eb">3.2 Linear maps</a></li><li><a href="matrices.html#417e6feb-e87a-4e49-b109-69c0efc11f20">3.3 Matrix multiplication</a></li><li><a href="matrices.html#f1ee71a3-f246-4de5-a059-0857e89b250b">3.4 Matrix arithmetic</a></li><li><a href="matrices.html#3ba68277-54c2-4417-8873-580221bf227c">3.5 The inverse matrix</a></li><li><a href="matrices.html#edae857a-385d-4193-a2ca-daff507009d4">3.6 The transposed matrix</a></li><li><a href="matrices.html#839cd3f2-52bf-43af-8af7-daa31bb1c266">3.7 Symmetric matrices</a></li></ul><li><a class="kap" href="whatisopt.html#60e76dc3-eb30-41ba-8542-172ddc1bc2a7"><b>4</b> What is optimization?</a></li><a href="#kap4" data-toggle="collapse"><span class="downtick">&#10095</span></a><ul id="kap4" class="collapse"><li><a href="whatisopt.html#a9f6c300-8b17-4ff9-9584-14821bbe7c43">4.1 What is an optimization problem?</a></li><li><a href="whatisopt.html#14942bc9-a19b-4efd-8a3a-12cf8cb0fe43">4.2 General definition</a></li><li><a href="whatisopt.html#29d4e276-f39d-4a07-a214-417d5dba2e09">4.3 Convex optimization</a></li><li><a href="whatisopt.html#20a70385-47c1-4b71-85b2-4baa80cba38d">4.4 Linear optimization</a></li><li><a href="whatisopt.html#63315831-1379-4a83-bc56-6b8b8eef2150">4.5 Fourier-Motzkin elimination</a></li><li><a href="whatisopt.html#0ab99069-0424-4ec8-a0ba-5a8067629c6e">4.6 Application in machine learning and data science</a></li></ul><li><a class="kap" href="euclidean.html#15dff35d-8cda-4b25-8751-6a59c8bc55a3"><b>5</b> Euclidean vector spaces</a></li><a href="#kap5" data-toggle="collapse"><span class="downtick">&#10095</span></a><ul id="kap5" class="collapse"><li><a href="euclidean.html#2e88a7de-ca93-46a4-8202-aa3c0add0f69">5.1 Vectors in the plane</a></li><li><a href="euclidean.html#367157fb-a772-41c1-be77-fdd8d3e0cc1f">5.2 Higher dimensions</a></li><li><a href="euclidean.html#65523d91-2925-4c74-91f9-a5258c9f1af3">5.3 An important remark about the real numbers</a></li><li><a href="euclidean.html#2bec1a82-9ba3-435d-bb8a-cea237b3fcd3">5.4 Sequences and limits</a></li><li><a href="euclidean.html#1a1ad702-0af7-45ef-abe2-b212777e81d9">5.5 Continuous functions</a></li><li><a href="euclidean.html#bae8f95a-2d6c-495a-a4d0-10f958e2ca12">5.6 Special subsets</a></li><li><a href="euclidean.html#cbd12a77-2916-4aca-aa99-246e17727e7c">5.7 The perceptron algorithm</a></li></ul></ul></div><div class="main normalmargin"><div style="margin-top:20px"></div><h1 id="60e76dc3-eb30-41ba-8542-172ddc1bc2a7">4<span style="float:right;">What is optimization?</span></h1><div style="margin-top:20px"></div>In this chapter we will denote the set of column vectors with <span class="math"></span><script type="math/tex">d</script> rows by <span class="math"></span><script type="math/tex">\mathbb{R}^d</script>.
The arithmetic
of <span class="math"></span><script type="math/tex">d\times 1</script> matrices apply i.e., we may add vectors in <span class="math"></span><script type="math/tex">\mathbb{R}^d</script> and
multiply them by a number in <span class="math"></span><script type="math/tex">\mathbb{R}</script>.<div style="margin-top:20px"></div>In the next chapter we will introduce them as <em>euclidean</em> vector spaces. The
term euclidean refers to a norm: a function measuring the size of a vector. In this
chapter we only need the structure as column vectors.<div style="margin-top:20px"></div><span id="sec4.1"></span><h2 id="a9f6c300-8b17-4ff9-9584-14821bbe7c43">4.1 What is an optimization problem?</h2><div style="margin-top:20px"></div>An optimization problem consists of maximizing or minimizing a function subject
to constraints.<div style="margin-top:20px"></div>Below are two classical examples related to minimizing (non-linear) functions subject to
(non-linear) constraints. These are actually examples of
convex optimization problems. More about that later.<div style="margin-top:20px"></div><span id="env4.1"></span><div class="example" data-count="4.1">     <div style="margin-top:20px"></div>A cylindrical can is supposed to have a volume of <span class="math"></span><script type="math/tex">V</script> <span class="math"></span><script type="math/tex">\text{m}^3</script>. The material used
  for the top and bottom costs <span class="math"></span><script type="math/tex">T</script> DKK per <span class="math"></span><script type="math/tex">\text{m}^2</script> and the material used for
  the side costs <span class="math"></span><script type="math/tex">S</script> DKK per <span class="math"></span><script type="math/tex">\text{m}^2</script>. Give the dimensions <span class="math"></span><script type="math/tex">r</script> and <span class="math"></span><script type="math/tex">h</script> of the
  can minimizing the prize of the materials.<div style="margin-top:20px"></div><div class="centerimg"><img src="img/cylinder.svg" ></div><div style="margin-top:20px"></div>The cost of the top and bottom pieces are <span class="math"></span><script type="math/tex">2 \pi r^2 T</script>. The cost of the
side material is <span class="math"></span><script type="math/tex">2\pi r h S</script>. The constraint is that the volume must be
<span class="math"></span><script type="math/tex">V</script>. This is expressed in the equation <span class="math"></span><script type="math/tex">\pi r^2 h = V</script>. All in all
the optimization problem is
<div class="math"></div><script type="math/tex; mode=display">\begin{aligned}
  &\text{Minimize} &2\pi r^2 T + 2\pi r h S&\\
  &\text{with constraints}\\
  &&\pi r^2 h &= V\\
  &&r &\geq 0\\
  &&h &\geq 0,
\end{aligned}</script>
where <span class="math"></span><script type="math/tex">V, T</script> and <span class="math"></span><script type="math/tex">S</script> are constants.<div style="margin-top:20px"></div></div><div style="margin-top:20px"></div><span id="env4.2"></span><div class="example" data-count="4.2">     
  A person is in distress <span class="math"></span><script type="math/tex">D</script> meters from the beach. The life guard
  spots the situation, but is <span class="math"></span><script type="math/tex">d</script> meters from where he would naturally jump
  in the water as indicated below. The life guard runs <span class="math"></span><script type="math/tex">8</script> m/s on the
  beach and swims <span class="math"></span><script type="math/tex">1</script> m/s in the water. How far (<span class="math"></span><script type="math/tex">x</script>) should he run along the
  beach before jumping into the water in order to minimize the time needed
  to reach the person in distress?<div style="margin-top:20px"></div><div class="centerimg"><img src="img/lifeguard.png" ></div><div style="margin-top:20px"></div>The time spent moving with a speed of <span class="math"></span><script type="math/tex">v</script> over a distance of <span class="math"></span><script type="math/tex">s</script> is
  <div class="math"></div><script type="math/tex; mode=display">
  t = \frac{s}{v}.
  </script>
  If the life guard jumps in the water at the point <span class="math"></span><script type="math/tex">x</script> he will have
  to swim a distance of
  <div class="math"></div><script type="math/tex; mode=display">
  \sqrt{D^2 + (d-x)^2}
  </script>
  using the Pythagorean theorem. Therefore the optimization problem becomes
<div class="math"></div><script type="math/tex; mode=display">\begin{aligned}
  &\text{Minimize} &\frac{x}{8} + \sqrt{D^2 + (d-x)^2}&\\
  &\text{with constraints}\\
  &&x\geq 0\\
\end{aligned}</script>
Strictly speaking we do not need the constraint <span class="math"></span><script type="math/tex">x\geq 0</script>, as the life guard is free
to run in the other direction. So the optimization problem is simply to minimize
<div class="math"></div><script type="math/tex; mode=display">
\frac{x}{8} + \sqrt{D^2 + (d-x)^2}
</script>
with no strings attached i.e., <span class="math"></span><script type="math/tex">x\in \mathbb{R}</script> is just assumed to be any number.<div style="margin-top:20px"></div><div class="sage"><script type="text/x-sage">
D = 200
d = 100
plot(x/8 + sqrt(D**2 + (d-x)**2), (x, 0, d))
</script></div><div style="margin-top:20px"></div></div><div style="margin-top:20px"></div><span id="env4.3"></span><a class="Exerciseno" data-count="4.3"></a><a href="#7d9cfac2-7489-478c-9030-8951367fd167" class ="btn btn-default Exercisebutton" data-toggle="collapse"></a><div id=7d9cfac2-7489-478c-9030-8951367fd167 class = "collapse Exercise envbuttons">  
  You need to build a rectangular fence in front of your house for a herb garden.
  Your house will make up one side of the rectangle, so you only need to build three
  sides. Suppose you have 10 m of wire. What is the maximum area of the herb garden you can
  wall in?
</div><div style="margin-top:20px"></div><span id="sec4.2"></span><h2 id="14942bc9-a19b-4efd-8a3a-12cf8cb0fe43">4.2 General definition</h2><div style="margin-top:20px"></div>An optimization problem consists of a subset <span class="math"></span><script type="math/tex">D\subseteq \mathbb{R}^d</script> and
a function <span class="math"></span><script type="math/tex">f:D\rightarrow \mathbb{R}</script>. We will consider optimization problems in the context
of minimization. Optimize in this situation means minimize.<div style="margin-top:20px"></div><div class="emphasize"><span id="env4.4"></span><div class="definition" data-count="4.4">     
  In our most general setting an optimization problem looks like
<div class="math"></div><script type="math/tex; mode=display">\begin{aligned}
  &\text{Minimize} &f(x)&\\
  &\text{with constraint}\\
  &&x\in C,
\end{aligned}</script>
     where <span class="math"></span><script type="math/tex">C</script> and <span class="math"></span><script type="math/tex">D</script> are subsets of <span class="math"></span><script type="math/tex">\mathbb{R}^d</script> with <span class="math"></span><script type="math/tex">C\subseteq D</script> and <span class="math"></span><script type="math/tex">f: D\rightarrow \mathbb{R}</script> is a function.
A solution to the optimization problem is a vector <span class="math"></span><script type="math/tex">x_0\in C</script>, such that
<div class="math"></div><script type="math/tex; mode=display">
f(x_0) \leq f(x)
</script>
for every <span class="math"></span><script type="math/tex">x\in C</script>. Here <span class="math"></span><script type="math/tex">x_0</script> is called an <em>optimum</em> and <span class="math"></span><script type="math/tex">f(x_0)</script> is called the <em>optimal value</em>.
</div></div><div style="margin-top:20px"></div>The complexity of the problem depends very much on the nature of <span class="math"></span><script type="math/tex">C</script> and <span class="math"></span><script type="math/tex">f</script>. Also,
  we cannot even be certain that an optimization problem has a solution. Consider
  the problem<div style="margin-top:20px"></div><div class="math"></div><script type="math/tex; mode=display">\begin{aligned}
    &\text{Minimize} &x\\
    &\text{with constraint}\\
    &&x\leq 0
  \end{aligned}</script><div style="margin-top:20px"></div>Here <span class="math"></span><script type="math/tex">x</script> can be made arbitrarily small subjsect to the constraint <span class="math"></span><script type="math/tex">x\leq 0</script> and
  the problem has no solution.<div style="margin-top:20px"></div><span id="env4.5"></span><a class="Exerciseno" data-count="4.5"></a><a href="#31b81b8c-9870-4639-a554-15e746455392" class ="btn btn-default Exercisebutton" data-toggle="collapse"></a><div id=31b81b8c-9870-4639-a554-15e746455392 class = "collapse Exercise envbuttons">  
    How do you turn a maximization problem
<div class="math"></div><script type="math/tex; mode=display">\begin{aligned}
  &\text{Maximize} &f(x)&\\
  &\text{with constraint}\\
  &&x\in C,
\end{aligned}</script>
    into a minimization problem?
    </div><div style="margin-top:20px"></div><span id="env4.6"></span><a class="Exerciseno" data-count="4.6"></a><a href="#89035264-4799-43c0-a905-89424dbc6a93" class ="btn btn-default Exercisebutton" data-toggle="collapse"></a><div id=89035264-4799-43c0-a905-89424dbc6a93 class = "collapse Exercise envbuttons">  
    Suppose that <span class="math"></span><script type="math/tex">a > 0</script>. Solve the optimization problem
<div class="math"></div><script type="math/tex; mode=display">\begin{aligned}
    &\text{Minimize} &a x^2 + b x + c\\
    &\text{with constraint}\\
    &&x\in \mathbb{R}.
  \end{aligned}</script><div style="margin-top:20px"></div></div><div style="margin-top:20px"></div><span id="sec4.3"></span><h2 id="29d4e276-f39d-4a07-a214-417d5dba2e09">4.3 Convex optimization</h2><div style="margin-top:20px"></div>Particularly well behaved optimization problems are the convex ones. These are optimization
    problems, where <span class="math"></span><script type="math/tex">C\subseteq \mathbb{R}^d</script> is a convex subset and <span class="math"></span><script type="math/tex">f:C\rightarrow \mathbb{R}</script> a
    convex function in Definition <a href=#env4.4 class="labelref">4.4</a>. To define these concepts we first introduce
    the notion of 
    a line in <span class="math"></span><script type="math/tex">\mathbb{R}^d</script>.<div style="margin-top:20px"></div><div class="emphasize"><span id="env4.7"></span><div class="definition" data-count="4.7">     
      A line <span class="math"></span><script type="math/tex">L\subseteq \mathbb{R}^d</script> is a subset of the form
      <div class="math"></div><script type="math/tex; mode=display">
      L = \{u + t v \mid t\in \mathbb{R}\},
      </script>
      where <span class="math"></span><script type="math/tex">u, v\in \mathbb{R}^d</script> with <span class="math"></span><script type="math/tex">v\neq 0</script>.
    </div></div><div style="margin-top:20px"></div><span id="env4.8"></span><a class="Exerciseno" data-count="4.8"></a><a href="#c749428b-ed3a-4d28-b17a-837db53a851c" class ="btn btn-default Exercisebutton" data-toggle="collapse"></a><div id=c749428b-ed3a-4d28-b17a-837db53a851c class = "collapse Exercise envbuttons">  
    Show in Definition <a href=#env4.7 class="labelref">4.7</a> that if <span class="math"></span><script type="math/tex">L</script> is given by <span class="math"></span><script type="math/tex">u</script> and <span class="math"></span><script type="math/tex">v</script>, then
    you might as well replace <span class="math"></span><script type="math/tex">v</script> by <span class="math"></span><script type="math/tex">\alpha v</script>, where <span class="math"></span><script type="math/tex">\alpha\neq 0</script>.  It gives
    the same line.
    </div><div style="margin-top:20px"></div><span id="env4.9"></span><div class="figure" data-count="4.9">     
  <div class="centerimg"><img src="img/line.png" ></div>
  <center>
    Example of a line in <span class="math"></span><script type="math/tex">\mathbb{R}^2</script> with (directional) vector <span class="math"></span><script type="math/tex">v\in \mathbb{R}^2</script> through the point <span class="math"></span><script type="math/tex">u\in \mathbb{R}^2</script>.
  </center>
</div><div style="margin-top:20px"></div><div class="emphasize"><span id="env4.10"></span><div class="exercise" data-count="4.10">     
  Show that there is a unique line passing through two distinct points
    <span class="math"></span><script type="math/tex">x, y\in \mathbb{R}^d</script> and that it is given by <span class="math"></span><script type="math/tex">u = x</script> and <span class="math"></span><script type="math/tex">v = y - x</script> in Definition <a href=#env4.7 class="labelref">4.7</a>.
</div></div><div style="margin-top:20px"></div><span id="env4.11"></span><a class="Exerciseno" data-count="4.11"></a><a href="#11daa306-ddd7-4cb6-b64f-1134eb97285e" class ="btn btn-default Exercisebutton" data-toggle="collapse"></a><div id=11daa306-ddd7-4cb6-b64f-1134eb97285e class = "collapse Exercise envbuttons">  
    Do the points
    <div class="math"></div><script type="math/tex; mode=display">
    \begin{pmatrix}1\\ 2\\ 3\end{pmatrix}, \quad \begin{pmatrix} 4\\ 5\\ 6\end{pmatrix}
    \quad\text{and}\quad \begin{pmatrix} 7\\ 8\\ 9\end{pmatrix}
    </script>
    lie on the same line in <span class="math"></span><script type="math/tex">\mathbb{R}^3</script>?
    </div><div style="margin-top:20px"></div><span id="env4.12"></span><a class="Exerciseno" data-count="4.12"></a><a href="#81ee9c1c-15e8-4c60-b91c-cc888d6ee39d" class ="btn btn-default Exercisebutton" data-toggle="collapse"></a><div id=81ee9c1c-15e8-4c60-b91c-cc888d6ee39d class = "collapse Exercise envbuttons">  
    Show that the line through two distinct points <span class="math"></span><script type="math/tex">x, y\in \mathbb{R}^d</script> is equal to the subset
    <div class="math"></div><script type="math/tex; mode=display">
    \{ (1-t) x + t y \mid t\in \mathbb{R}\} \subseteq \mathbb{R}^d.
    </script>
    </div><div style="margin-top:20px"></div><div class="emphasize"><span id="env4.13"></span><div class="definition" data-count="4.13">     
    A convex subset <span class="math"></span><script type="math/tex">C\subseteq \mathbb{R}^d</script> is a subset that contains the
    line segment between any two of its points <span class="math"></span><script type="math/tex">x, y\in C</script> i.e.,
    <div class="math"></div><script type="math/tex; mode=display">
    (1 - t) x + t y\in C
    </script>
    for every number <span class="math"></span><script type="math/tex">t</script> with <span class="math"></span><script type="math/tex">0\leq t \leq 1</script>.
    </div></div><div style="margin-top:20px"></div><span id="env4.14"></span><div class="figure" data-count="4.14">     
  <div class="centerimg"><img src="img/nonconvex.png" ></div>
  <center>
    Example of non-convex subset of <span class="math"></span><script type="math/tex">\mathbb{R}^2</script>.
  </center>
</div><div style="margin-top:20px"></div><span id="env4.15"></span><a class="Quizexerciseno" data-count="4.15"></a><a href="#666795d9-fb4e-45b3-a481-b276d0d42809" class ="btn btn-default Quizexercisebutton" data-toggle="collapse"></a><div id=666795d9-fb4e-45b3-a481-b276d0d42809 class = "collapse Quizexercise envbuttons">  
  <span id="{labelname}"></span><div id="quiz1" style="width:100%;"><div class="row quizquestion">
    Which of the subsets below are convex?
    </div><div class="row"><div class="col-xs-5 quizanswer" datav="T">
    <div class="math"></div><script type="math/tex; mode=display">C=\{1\}\subseteq \mathbb{R}</script>
    </div><div class="col-xs-5 quizanswer" datav="F">
    <div class="math"></div><script type="math/tex; mode=display">C=\{1, 2\}\subseteq \mathbb{R}</script>
    </div><div class="col-xs-5 quizanswer" datav="T">
    The points <span class="math"></span><script type="math/tex">C</script> on a line <span class="math"></span><script type="math/tex">y = a x + b</script> in <span class="math"></span><script type="math/tex">\mathbb{R}^2</script>.
    </div><div class="col-xs-5 quizanswer" datav="F">
    <div class="math"></div><script type="math/tex; mode=display">
    C=\{(x, y)\in \mathbb{R}^2 \mid x y \geq 0\}.
    </script>
  </div></div></div><button id="quizbutton1" class = "btn btn-default">Check</button><script>$("#quizbutton1").click(function(){quizshowanswers(quiz1, quizbutton1);});</script>
</div><div style="margin-top:20px"></div><span id="env4.16"></span><a class="Exerciseno" data-count="4.16"></a><a href="#b7720f0e-02e9-4e62-ade7-4b71f5b0a8e0" class ="btn btn-default Exercisebutton" data-toggle="collapse"></a><div id=b7720f0e-02e9-4e62-ade7-4b71f5b0a8e0 class = "collapse Exercise envbuttons">  
      A closed interval in <span class="math"></span><script type="math/tex">\mathbb{R}</script> is a subset of the form
      <div class="math"></div><script type="math/tex; mode=display">
      [a, b] = \{x \mid a \leq x \leq b\}
      </script>
      for <span class="math"></span><script type="math/tex">a \leq b</script>. Prove that <span class="math"></span><script type="math/tex">[a, b]</script> is a convex subset of <span class="math"></span><script type="math/tex">\mathbb{R}</script>.
      </div><div style="margin-top:20px"></div>      
    <span id="env4.17"></span><a class="Exerciseno" data-count="4.17"></a><a href="#a163d00a-97fb-4e2e-a255-86e9f480125b" class ="btn btn-default Exercisebutton" data-toggle="collapse"></a><div id=a163d00a-97fb-4e2e-a255-86e9f480125b class = "collapse Exercise envbuttons">  
    Let <span class="math"></span><script type="math/tex">A</script> and <span class="math"></span><script type="math/tex">B</script> be convex subsets of <span class="math"></span><script type="math/tex">\mathbb{R}^d</script>. Prove that <span class="math"></span><script type="math/tex">A\cap B</script> is a
    convex subset of <span class="math"></span><script type="math/tex">\mathbb{R}^d</script>. Generalize this to show that if <span class="math"></span><script type="math/tex">A_1, \dots, A_n</script>
    are any number of convex subsets of <span class="math"></span><script type="math/tex">\mathbb{R}^d</script>, then their intersection
    <div class="math"></div><script type="math/tex; mode=display">
    A_1 \cap \cdots \cap A_n
    </script>
    is a convex subset of <span class="math"></span><script type="math/tex">\mathbb{R}^d</script>. Is the union of two convex subsets necessarily convex?
    </div><div style="margin-top:20px"></div><div class="emphasize"><span id="env4.18"></span><div class="definition" data-count="4.18">     
    A convex function is a function <span class="math"></span><script type="math/tex">f: C\rightarrow \mathbb{R}</script>
    defined on a convex subset <span class="math"></span><script type="math/tex">C\subseteq \mathbb{R}^d</script>, such that
    <div class="math"></div><script type="math/tex; mode=display">
    f((1 - t) x + t y) \leq (1-t) f(x) + t f(y)
    </script>
    for every number <span class="math"></span><script type="math/tex">t</script> with <span class="math"></span><script type="math/tex">0\leq t \leq 1</script>.
    </div></div><div style="margin-top:20px"></div><span id="env4.19"></span><div class="figure" data-count="4.19">     
  <div class="centerimg"><img src="img/convexfct.png" ></div>
  <center>
    Graph of convex function. The line segment between <span class="math"></span><script type="math/tex">(x, f(x))</script> and <span class="math"></span><script type="math/tex">(y, f(y))</script>
    lies above the graph.
  </center>
</div><div style="margin-top:20px"></div><span id="env4.20"></span><a class="Exerciseno" data-count="4.20"></a><a href="#08dd9096-0a84-41b1-87e6-27c985288e40" class ="btn btn-default Exercisebutton" data-toggle="collapse"></a><div id=08dd9096-0a84-41b1-87e6-27c985288e40 class = "collapse Exercise envbuttons">  
    Let the function <span class="math"></span><script type="math/tex">f: \mathbb{R} \rightarrow \mathbb{R}</script> be given by
    <span class="math"></span><script type="math/tex">f(x) = a x + b</script>, where <span class="math"></span><script type="math/tex">a, b\in \mathbb{R}</script>. Show that <span class="math"></span><script type="math/tex">f</script> is a convex
    function.<div style="margin-top:20px"></div><a href="#09262eff-8883-4df7-a76f-4856294b5ad8" class ="btn btn-default" data-toggle="collapse">Hint</a><div id=09262eff-8883-4df7-a76f-4856294b5ad8 class="collapse">
      Try the case <span class="math"></span><script type="math/tex">a = 0</script> first.
    </div><div style="margin-top:20px"></div>Can you at this point prove that <span class="math"></span><script type="math/tex">f(x) = x^2</script> is a convex function?<div style="margin-top:20px"></div><a href="#909df189-77a5-4d6b-ac76-c4422fc9ab5b" class ="btn btn-default" data-toggle="collapse">Hint</a><div id=909df189-77a5-4d6b-ac76-c4422fc9ab5b class="collapse">
      Simplify
      <div class="math"></div><script type="math/tex; mode=display">
      (1 - t) x^2 + t y^2 - ((1-t) x + t y)^2
      </script>
      to an expression that has to be non-negative.<div style="margin-top:20px"></div><a href="#b131f9c6-3dfa-401d-9f7d-7914877e5530" class ="btn btn-default" data-toggle="collapse">Hint</a><div id=b131f9c6-3dfa-401d-9f7d-7914877e5530 class="collapse">
        <div class="sage"><script type="text/x-sage">
from sympy.abc import x, y, t
f = (1-t)*x^2 + t*y^2 - ((1-t)*x + t*y)^2
factor(f)
        </script></div>
    </div>
  </div><div style="margin-top:20px"></div>Using that <span class="math"></span><script type="math/tex">f(x) = x^2</script> is a a convex function, prove that <span class="math"></span><script type="math/tex">g(x) = x^4</script> is a convex function and in general, that <span class="math"></span><script type="math/tex">h(x) = x^m</script> is a convex function, where
  <span class="math"></span><script type="math/tex">m = 2n</script> is an even natural number.<div style="margin-top:20px"></div><a href="#42dbe08b-536c-4727-87fe-73517431fce1" class ="btn btn-default" data-toggle="collapse">Hint</a><div id=42dbe08b-536c-4727-87fe-73517431fce1 class="collapse">
      <div class="math"></div><script type="math/tex; mode=display">g(x) = f(x)^2</script>
    </div><div style="margin-top:20px"></div>It is a fact that <span class="math"></span><script type="math/tex">f(x) = x^3</script> is not a convex function, but can
    you explain this using the definition of a convex function?<div style="margin-top:20px"></div><a href="#aa5058b5-2d80-4b6e-94e0-db73ba67f9fe" class ="btn btn-default" data-toggle="collapse">Hint</a><div id=aa5058b5-2d80-4b6e-94e0-db73ba67f9fe class="collapse">
      Try <span class="math"></span><script type="math/tex">x = -1, y = 0</script> and <span class="math"></span><script type="math/tex">t =\frac{1}{2}</script>.
    </div>
    </div><div style="margin-top:20px"></div><div class="emphasize"><span id="env4.21"></span><div class="exercise" data-count="4.21">     
    Let <span class="math"></span><script type="math/tex">f: \mathbb{R}^d\rightarrow \mathbb{R}</script> be a convex function. Show that the subset
    <div class="math"></div><script type="math/tex; mode=display">
    C = \{x\in \mathbb{R}^d \mid f(x) \leq a\}
    </script>
    is a convex subset of <span class="math"></span><script type="math/tex">\mathbb{R}^d</script>, where <span class="math"></span><script type="math/tex">a</script> is a number.
    </div></div><div style="margin-top:20px"></div>We do not have the tools yet to prove the crucial
    result about convex optimization problems, but at least we can state it.<div style="margin-top:20px"></div><span id="env4.22"></span><div class="remark" data-count="4.22">     
    In hunting for optimal solutions to an optimization problem one is often stuck with a
    point <span class="math"></span><script type="math/tex">x_0\in \mathbb{R}^d</script>, which is optimal locally. This means that <span class="math"></span><script type="math/tex">f(x_0)\leq f(x)</script> for
    every <span class="math"></span><script type="math/tex">x</script> that is sufficiently close to <span class="math"></span><script type="math/tex">x</script> (we will explain what this means in the next
    chapter). The remarkable thing that happens in a convex optimization problem is
    that if <span class="math"></span><script type="math/tex">x_0</script> is optimal locally, then it is a global optimum! It satisfies
    <span class="math"></span><script type="math/tex">f(x_0)\leq f(x)</script> not only for <span class="math"></span><script type="math/tex">x</script> close to <span class="math"></span><script type="math/tex">x_0</script>, but for every <span class="math"></span><script type="math/tex">x\in C</script>.
</div><div style="margin-top:20px"></div>The optimization problem in Exercise <a href=#env4.6 class="labelref">4.6</a> is a very typical convex optimization
    problem.<div style="margin-top:20px"></div>Below you see a plot of the function (press Compute)
    <div class="math"></div><script type="math/tex; mode=display">
    f(x) = x^3 + 2 x^2 + x + 1
    </script>
    restricted
    to the interval <span class="math"></span><script type="math/tex">[-1.5, 0]</script>. You can see that it has a local minimum around <span class="math"></span><script type="math/tex">-0.3</script> and
    also that this minimum is not a global minimum (certainly <span class="math"></span><script type="math/tex">f(-1.4)</script> is smaller). So <span class="math"></span><script type="math/tex">f(x)</script>
    is not a convex function on this interval (but if you look at it more locally on the
    interval <span class="math"></span><script type="math/tex">[-0.6, 0]</script> it is a convex function.<div style="margin-top:20px"></div><div class="sage"><script type="text/x-sage">
      plot(x**3+2*x**2+x+1, (x, -1.5, 0))
    </script></div><div style="margin-top:20px"></div><span id="env4.23"></span><a class="Exerciseno" data-count="4.23"></a><a href="#fbb7454e-ea46-42c6-ba16-87eb70678ec0" class ="btn btn-default Exercisebutton" data-toggle="collapse"></a><div id=fbb7454e-ea46-42c6-ba16-87eb70678ec0 class = "collapse Exercise envbuttons">  
    Solve the optimization problem
    <div class="math"></div><script type="math/tex; mode=display">\begin{aligned}
    &\text{Minimize} &x^3 + 2 x^2 + x + 1\\
    &\text{with constraint}\\
      &&x\in C
    \end{aligned}</script>
    for <span class="math"></span><script type="math/tex">C = [-0.6, 0]</script> and <span class="math"></span><script type="math/tex">C = [-2, 0]</script>.
    </div><div style="margin-top:20px"></div><span id="sec4.4"></span><h2 id="20a70385-47c1-4b71-85b2-4baa80cba38d">4.4 Linear optimization</h2><div style="margin-top:20px"></div>The simplest convex optimization problems are the linear ones. Recall that a
  linear function <span class="math"></span><script type="math/tex">f: \mathbb{R}^d\rightarrow \mathbb{R}</script> has the form
  <div class="math"></div><script type="math/tex; mode=display">
  f\begin{pmatrix} x_1 \\ \vdots \\ x_n \end{pmatrix} =
  c_1 x_1 + \cdots + c_n x_n
  </script>
  for <span class="math"></span><script type="math/tex">c_1, \dots, c_n\in \mathbb{R}</script>. Usually we write this with matrix notation as
  <div class="math"></div><script type="math/tex; mode=display">
  f(x) = c^T x,
  </script>
  where
  <div class="math"></div><script type="math/tex; mode=display">
  c =
  \begin{pmatrix} c_1 \\ \vdots \\ c_n \end{pmatrix}\qquad \text{and} \qquad
  x = \begin{pmatrix} x_1 \\ \vdots \\ x_n \end{pmatrix}.
  </script><div style="margin-top:20px"></div><span id="env4.24"></span><a class="Exerciseno" data-count="4.24"></a><a href="#9525aa9a-6345-440a-b440-f9602f235d53" class ="btn btn-default Exercisebutton" data-toggle="collapse"></a><div id=9525aa9a-6345-440a-b440-f9602f235d53 class = "collapse Exercise envbuttons">  
  Show that a linear function is convex.
  </div><div style="margin-top:20px"></div>A linear optimization problem is not about minimizing a linear function over
  an arbitrary convex subset. We choose the convex subset as an intersection of
  subsets of the form
  <div class="math"></div><script type="math/tex; mode=display">
  \{x\in \mathbb{R}^d\mid a^T x \leq b\},
  </script>
  where <span class="math"></span><script type="math/tex">a\in \mathbb{R}^d</script> is a non-zero vector and <span class="math"></span><script type="math/tex">b\in \mathbb{R}</script> a number i.e.,
  a linear optimization problem has the form
  <div class="math"></div><script type="math/tex; mode=display">\begin{aligned}
    &\text{Minimize} &c^T x\\
    &\text{with constraint}\\
      &&x\in C,
  \end{aligned}</script>
  where
  <span id="equ4.1"></span><div class="math"></div><script type="math/tex; mode=display">\begin{aligned}
    C &= \{x\in \mathbb{R}^d \mid a_1^T x \leq b_1, \dots, a_m^T x\leq b_m\}\\
    &= \{x\in \mathbb{R}^d \mid a_1^T x \leq b_1\} \cap \cdots \cap \{x\in \mathbb{R}^d \mid a_m^T x \leq b_m\}
  \end{aligned}\tag{4.1}</script>
  and <span class="math"></span><script type="math/tex">c, a_1, \dots, a_m\in \mathbb{R}^d</script> and <span class="math"></span><script type="math/tex">b_1, \dots, b_m\in \mathbb{R}</script>.<div style="margin-top:20px"></div><span id="env4.25"></span><a class="Exerciseno" data-count="4.25"></a><a href="#b13fcc9c-a138-4df4-bcba-4695404ea5fc" class ="btn btn-default Exercisebutton" data-toggle="collapse"></a><div id=b13fcc9c-a138-4df4-bcba-4695404ea5fc class = "collapse Exercise envbuttons">  
  Use a selection of previous exercises to show that
  the subset <span class="math"></span><script type="math/tex">C</script> defined in <a href=#equ4.1>(4.1)</a> is a convex subset of <span class="math"></span><script type="math/tex">\mathbb{R}^d</script>.
  </div><div style="margin-top:20px"></div>Using matrix notation we write <span class="math"></span><script type="math/tex">C</script> as
  <div class="math"></div><script type="math/tex; mode=display">
  C = \{x\in \mathbb{R}^d \mid A x \leq b\},
  </script>
  where <span class="math"></span><script type="math/tex">A</script> is the <span class="math"></span><script type="math/tex">m\times d</script> matrix with row vectors <span class="math"></span><script type="math/tex">a_1^T, \dots, a_m^T</script> and
  <div class="math"></div><script type="math/tex; mode=display">
  b =
  \begin{pmatrix}
    b_1 \\ \vdots \\ b_m
  \end{pmatrix}.
  </script><div style="margin-top:20px"></div><span id="env4.26"></span><div class="example" data-count="4.26">     <div style="margin-top:20px"></div>Here is a concrete example for <span class="math"></span><script type="math/tex">d = 2</script>. The optimization problem
  <div class="math"></div><script type="math/tex; mode=display">\begin{aligned}
    &\text{Maximize} &x + y&\\
    &\text{with constraints}\\
    &&2 x + y &\leq 1\\
    &&x + 2 y &\leq 1\\
    &&x &\geq 0\\
    &&y &\geq 0
  \end{aligned}</script>
  translates into matrix notation with the matrices
  
  <div class="math"></div><script type="math/tex; mode=display">
  c = \begin{pmatrix} 1 \\ 1 \end{pmatrix}, \qquad
  A = \begin{pmatrix} \hphantom{-} 2 & \hphantom{-} 1 \\ \hphantom{-} 1 & \hphantom{-} 2 \\ -1 & \hphantom{-} 0 \\ \hphantom{-} 0 & - 1\end{pmatrix}\qquad \text{and}\qquad
  b = \begin{pmatrix} 1 \\ 1 \\ 0 \\ 0 \end{pmatrix}.
  </script><div style="margin-top:20px"></div>In this case it is helpful to draw the optimization problem in the plane <span class="math"></span><script type="math/tex">\mathbb{R}^2</script>. This is done below.<div style="margin-top:20px"></div><div class="centerimg"><img src="img/LP.png" ></div>
  <center>
    Constraints pictured as shaded area above. Optimum occurs in a vertex (corner).
    </center><div style="margin-top:20px"></div></div><div style="margin-top:20px"></div>We will give a general (but rather slow) algorithm below for solving
  linear optimization problems. In fact it all boils down to solving
  systems of linear inequalities. Sometimes linear optimization is
  referred to as <a href="https://en.wikipedia.org/wiki/Linear_programming" target="_blank">linear
    programming</a>. The
  basic theory of linear programming was pioneered, among others, by
  one of the inventors of the modern computer, John von Neumann.<div style="margin-top:20px"></div><div class="centerimg"><img src="img/vonNeumann.gif" ></div>
<center>
  <a href="https://en.wikipedia.org/wiki/John_von_Neumann" target="_blank">John von Neumann</a> (1903-1957). Picture from <a href="https://en.wikipedia.org/wiki/Los_Alamos_National_Laboratory" target="_blank">LANL</a>.
</center><div style="margin-top:20px"></div>Sage has much more advanced algorithms built in for solving (integer) linear optimization
  problems. I have translated the linear optimization problem in Example <a href=#env4.26 class="labelref">4.26</a> into
  Sage below.<div style="margin-top:20px"></div><div class="sage"><script type="text/x-sage">
LP = MixedIntegerLinearProgram(solver = "GLPK")

# generate variables (do not require integer solution) 
x = LP.new_variable(integer=False)

# Linear function to be maximized (notice maximized!)

LP.set_objective(x[1] + x[2])

# Add constraints
LP.add_constraint( 2*x[1] + x[2] <= 1 );
LP.add_constraint( x[1] + 2*x[2] <= 1 );
LP.add_constraint( x[1] >= 0 );
LP.add_constraint( x[2] >= 0 );

LP.show()

oval = LP.solve()
xopt = LP.get_values(x);

print('Optimal Value:', oval)
print('occurs in')
for i, v in xopt.items():
    print('x_%s = %f' % (i, v))
</script></div><div style="margin-top:20px"></div><span id="sec4.5"></span><h2 id="63315831-1379-4a83-bc56-6b8b8eef2150">4.5 Fourier-Motzkin elimination</h2><div style="margin-top:20px"></div>Fourier-Motzkin elimination is a classical method (dating back to 1826) for solving linear inequalities. 
It is also a key ingredient in an algorithm for solving linear optimization problems.<div style="margin-top:20px"></div>I am convinced that
the best way to explain this method is by way of an extended example. For more formalities you may
consult <a href="https://www.worldscientific.com/doi/suppl/10.1142/8527/suppl_file/8527_chap01.pdf" target="_blank">Chapter 1</a> of my book <a href="https://www.worldscientific.com/worldscibooks/10.1142/8527" target="_blank">Undergraduate Convexity</a>.<div style="margin-top:20px"></div>Consider the linear optimization problem<div style="margin-top:20px"></div><span id="equ4.2"></span><div class="math"></div><script type="math/tex; mode=display">
  \begin{array}{llrrrr}
    &\text{Maximize} &x + y\\
    &\text{with constraints}\\
    &&2 x &+ &y &\leq &6\\
    &&x &+ &2 y &\leq &6\\
    &&x &+ &2 y &\geq &2\\
    &&x && &\geq &0\\
    &&&&y &\geq &0.
  \end{array}
\tag{4.2}</script><div style="margin-top:20px"></div>We might as well write this as<div style="margin-top:20px"></div><div class="math"></div><script type="math/tex; mode=display">
  \begin{array}{llrrrl}
    &\text{Maximize} &z\\
    &\text{with constraints}\\
    &&&& z &= &x + y\\
    &&2 x &+ &y &\leq &6\\
    &&x &+ &2 y &\leq &6\\
    &&x &+ &2 y &\geq &2\\
    &&x &&&\geq &0\\
    &&&&y &\geq &0
  \end{array}
</script><div style="margin-top:20px"></div>by adding the extra variable <span class="math"></span><script type="math/tex">z</script>. This enables us to reformulate the problem as follows: Find
  the maximal value of <span class="math"></span><script type="math/tex">z</script>, such that there exists <span class="math"></span><script type="math/tex">(x, y)\in \mathbb{R}^2</script> with
  <div class="math"></div><script type="math/tex; mode=display">
  (x, y, z)\in P,
  </script>
  where <span class="math"></span><script type="math/tex">P\subseteq \mathbb{R}^3</script> is the set of solutions to the system<div style="margin-top:20px"></div><span id="equ4.3"></span><div class="math"></div><script type="math/tex; mode=display">

\begin{array}{llrrrl}
    &&&& z &= &x + y\\
    &&2 x &+ &y &\leq &6\\
    &&x &+ &2 y &\leq &6\\
    &&x &+ &2 y &\geq &2\\
    &&x &&&\geq &0\\
    &&&&y &\geq &0
  \end{array}

\tag{4.3}</script><div style="margin-top:20px"></div><div style="margin-top:20px"></div>of <span class="footnote">inequalities<span class="footnotetext">An equality <span class="math"></span><script type="math/tex">a = b</script> is logically equivalent to the two
    inequalities <span class="math"></span><script type="math/tex">a\leq b</script> and <span class="math"></span><script type="math/tex">a \geq b</script> in the sense that <span class="math"></span><script type="math/tex">(a\leq b) \wedge (a\geq b) \iff a = b</script>.</span></span>.<div style="margin-top:20px"></div>We have the Gauss elimination method for solving systems of linear equations. How do we now solve
  <a href=#equ4.3>(4.3)</a>, where we also have inequalities?<div style="margin-top:20px"></div>Well, at first we can actually do a Gauss elimination step by eliminating <span class="math"></span><script type="math/tex">x</script> in the equation
  <span class="math"></span><script type="math/tex">z = x + y</script> i.e., by putting <span class="math"></span><script type="math/tex">x = z - y</script>. This is then inserted into the inequalities in
  <a href=#equ4.3>(4.3)</a>:<div style="margin-top:20px"></div><div class="math"></div><script type="math/tex; mode=display">
\begin{array}{llrrrl}
    &&2 (z - y) &+ &y &\leq &6\\
    &&(z - y) &+ &2 y &\leq &6\\
    &&(z - y) &+ &2 y &\geq &2\\
    &&(z - y) &  &    &\geq &0\\
    &&          &  &  y &\geq &0
\end{array}
</script><div style="margin-top:20px"></div>and we get the system <div style="margin-top:20px"></div><div class="math"></div><script type="math/tex; mode=display">
  \begin{array}{llrrrl}
    &&2 z &- &y&\leq &6\\
    &&z &+ &y &\leq &6\\
    &&z &+ & y &\geq &2\\
    &&z &- &y &\geq &0\\
    &&  &  &y   &\geq &0
  \end{array}
</script>
  of inequalities
  in the variables <span class="math"></span><script type="math/tex">z</script> and <span class="math"></span><script type="math/tex">y</script>. Now we only have inequalities left and we have to invent a trick for
  eliminating <span class="math"></span><script type="math/tex">y</script>. Let us isolate <span class="math"></span><script type="math/tex">y</script> on one side of the inequality signs <span class="math"></span><script type="math/tex">\leq</script> and <span class="math"></span><script type="math/tex">\geq</script>:<div style="margin-top:20px"></div><div class="math"></div><script type="math/tex; mode=display">
    \begin{array}{llrrrl}
    &&2 z &- &6 &\leq &y\\
    &&6 &- &z &\geq &y\\
    &&2 &- &z &\leq &y\\
    && & &z &\geq &y\\
    &&&&0 &\leq &y
  \end{array}
</script><div style="margin-top:20px"></div>Written a little differently this is the same as<div style="margin-top:20px"></div><span id="equ4.4"></span><div class="math"></div><script type="math/tex; mode=display">
  \begin{array}{llrrrl}
    &&2 z &- &6&\leq &{\color{red} y} \\
    &&&&&&{\color{red} y} &\leq &6 &- &z\\
    &&2&- &z&\leq &{\color{red} y} \\
    &&&&&&{\color{red} y} &\leq &z\\
    &&&&0&\leq &{\color{red} y}
  \end{array}
\tag{4.4}</script><div style="margin-top:20px"></div>Now the scene is set for elimination of <span class="math"></span><script type="math/tex">y</script>. Listen carefully. First the inequalities in 
<a href=#equ4.4>(4.4)</a> can be boiled down to the following two inequalities<div style="margin-top:20px"></div><span id="equ4.5"></span><div class="math"></div><script type="math/tex; mode=display">
  \begin{array}{lllll}
\max(2 z - 6, 2 - z, 0) &\leq &{\color{red} y}\\
&& {\color{red} y} & \leq &\min(6 - z, z).
  \end{array}
\tag{4.5}</script>
using (repeatedly) that  <span class="math"></span><script type="math/tex">\max(a, b) \leq c \iff a\leq c \wedge b\leq c</script> and
  <span class="math"></span><script type="math/tex">c\leq \min(a, b) \iff c\leq a \wedge c\leq b</script> for three
numbers <span class="math"></span><script type="math/tex">a, b, c\in \mathbb{R}</script>.<div style="margin-top:20px"></div>Then, finally comes the (Fourier-Motzkin) elimination step: The existence of a solution to <a href=#equ4.5>(4.5)</a> is
equivalent to the single inequality<div style="margin-top:20px"></div><span id="equ4.6"></span><div class="math"></div><script type="math/tex; mode=display">
\max(2 z - 6, 2 - z, 0) \leq \min(6 - z, z).
\tag{4.6}</script><div style="margin-top:20px"></div>This single inequality can be exploded or expanded (see Exercise <a href="whatisopt.html#env4.28">4.28</a>) into the following <span class="math"></span><script type="math/tex">6 = 3\cdot 2</script> inequalities<div style="margin-top:20px"></div><div class="math"></div><script type="math/tex; mode=display">\begin{aligned}
2 z - 6 &\leq 6 - z\\
2 z - 6 &\leq z\\
2 - z &\leq 6 - z\\
2 - z &\leq z\\
0 &\leq 6 - z\\
0 &\leq z.
\end{aligned}</script><div style="margin-top:20px"></div>Similarly to <a href=#equ4.4>(4.4)</a> we now isolate <span class="math"></span><script type="math/tex">z</script> from the above inequalities:<div style="margin-top:20px"></div><div class="math"></div><script type="math/tex; mode=display">
  \begin{array}{lllll}
&&&{\color{red} z} &\leq &4\\
&&&{\color{red} z} &\leq &6\\
&1&\leq &{\color{red} z}\\
&&&{\color{red} z} &\leq &6\\
&0&\leq &{\color{red} z}
\end{array}
</script><div style="margin-top:20px"></div>and find that<div style="margin-top:20px"></div><div class="math"></div><script type="math/tex; mode=display">
  \begin{array}{lllll}
\max(1, 0) = 1 &\leq &{\color{red} z}\\
&& {\color{red} z} & \leq &\min(4, 6) = 4.
  \end{array}
</script><div style="margin-top:20px"></div>Therefore the maximum in the optimization problem <a href=#equ4.2>(4.2)</a> is <span class="math"></span><script type="math/tex">z = x + y = 4</script>. 
How do we now find numbers <span class="math"></span><script type="math/tex">x, y\in \mathbb{R}</script> satisfying the constraints
in the optimization problem <a href=#equ4.2>(4.2)</a> with <span class="math"></span><script type="math/tex">z = x + y = 4</script>?<div style="margin-top:20px"></div>This is simply done inserting first <span class="math"></span><script type="math/tex">z = 4</script> in <a href=#equ4.5>(4.5)</a>. Here you get the two inequalities
<span class="math"></span><script type="math/tex">2 \leq y</script> and <span class="math"></span><script type="math/tex">y\leq 2</script>. Therefore <span class="math"></span><script type="math/tex">y = 2</script>. Since we had <span class="math"></span><script type="math/tex">x = z - y</script> from the bery beginning
we therefore get <span class="math"></span><script type="math/tex">x = 2</script> and we have the unique solution to the optimization problem.<div style="margin-top:20px"></div><span id="env4.27"></span><a class="Exerciseno" data-count="4.27"></a><a href="#d216be93-dd33-45d4-b331-0f56f4806c9e" class ="btn btn-default Exercisebutton" data-toggle="collapse"></a><div id=d216be93-dd33-45d4-b331-0f56f4806c9e class = "collapse Exercise envbuttons">  
What is the solution if we replace Maximize with Minimize in the optimization problem <a href=#equ4.2>(4.2)</a>?
</div><div style="margin-top:20px"></div><span id="env4.28"></span><a class="Exerciseno" data-count="4.28"></a><a href="#9a0ab014-764d-429f-bb66-c3c428e53214" class ="btn btn-default Exercisebutton" data-toggle="collapse"></a><div id=9a0ab014-764d-429f-bb66-c3c428e53214 class = "collapse Exercise envbuttons">  <div style="margin-top:20px"></div>Prove the following:<div style="margin-top:20px"></div>Let <span class="math"></span><script type="math/tex">x_1, \dots, x_m, y_1, \dots, y_n\in \mathbb{R}</script> be <span class="math"></span><script type="math/tex">m + n</script> numbers. Then
    <div class="math"></div><script type="math/tex; mode=display">
    \max(x_1, \dots, x_m) \leq \min(y_1, \dots, y_n)
    </script>
    if and only if the <span class="math"></span><script type="math/tex">m n</script> inequalities
    <div class="math"></div><script type="math/tex; mode=display">
    \begin{matrix}
      &x_1 \leq y_1 &x_1 \leq y_2 &\dots &x_1\leq y_n\\
      \\
      &\vdots & \vdots &\ddots &\vdots\\
      \\
      &x_m \leq y_1 &x_m \leq y_2 &\dots &x_m\leq y_n
    \end{matrix}
    </script>
    are satisfied.
</div><div style="margin-top:20px"></div><span id="env4.29"></span><a class="Exerciseno" data-count="4.29"></a><a href="#06f0db68-6c96-49b5-b107-46e228b8c156" class ="btn btn-default Exercisebutton" data-toggle="collapse"></a><div id=06f0db68-6c96-49b5-b107-46e228b8c156 class = "collapse Exercise envbuttons">  <div style="margin-top:20px"></div>The following is Exercise 1.8 from my book <a href="https://www.worldscientific.com/worldscibooks/10.1142/8527" target="_blank">Undergraduate Convexity</a>.<div style="margin-top:20px"></div>A vitamin pill <span class="math"></span><script type="math/tex">P</script> is produced using two ingredients <span class="math"></span><script type="math/tex">M_1</script>
  and <span class="math"></span><script type="math/tex">M_2</script>. The pill needs to satisfy four constraints for the vital
  vitamins <span class="math"></span><script type="math/tex">V_1</script> and <span class="math"></span><script type="math/tex">V_2</script>. It must contain at least <span class="math"></span><script type="math/tex">6</script> milligrams and
  at most <span class="math"></span><script type="math/tex">15</script> milligrams of <span class="math"></span><script type="math/tex">V_1</script> and at least <span class="math"></span><script type="math/tex">5</script> milligrams and at
  most <span class="math"></span><script type="math/tex">12</script> milligrams of <span class="math"></span><script type="math/tex">V_2</script>. The ingredient <span class="math"></span><script type="math/tex">M_1</script> contains <span class="math"></span><script type="math/tex">3</script>
  milligrams of <span class="math"></span><script type="math/tex">V_1</script> and <span class="math"></span><script type="math/tex">2</script> milligrams of <span class="math"></span><script type="math/tex">V_2</script> per gram.  The
  ingredient <span class="math"></span><script type="math/tex">M_2</script> contains <span class="math"></span><script type="math/tex">2</script> milligrams of <span class="math"></span><script type="math/tex">V_1</script> and <span class="math"></span><script type="math/tex">3</script> milligrams
  of <span class="math"></span><script type="math/tex">V_2</script> per gram:<div style="margin-top:20px"></div><div class="math"></div><script type="math/tex; mode=display">
\def\arraystretch{1.5}
\begin{array}{c|cc}
& V_1 & V_2\\ \hline
M_1 & 3 & 2\\
M_2 & 2 & 3
\end{array}
</script><div style="margin-top:20px"></div>Let <span class="math"></span><script type="math/tex">x</script> denote the amount of <span class="math"></span><script type="math/tex">M_1</script> and <span class="math"></span><script type="math/tex">y</script> the amount of <span class="math"></span><script type="math/tex">M_2</script>
  (measured in grams) in the production of a vitamin pill. Write down
  a system of linear inequalities in <span class="math"></span><script type="math/tex">x</script> and <span class="math"></span><script type="math/tex">y</script> describing the
  constraints above.<div style="margin-top:20px"></div>We want a vitamin pill of minimal weight satisfying the
  constraints. How many grams of <span class="math"></span><script type="math/tex">M_1</script> and <span class="math"></span><script type="math/tex">M_2</script> should we mix?
  Describe how Fourier-Motzkin elimination can be used in solving this
  problem.<div style="margin-top:20px"></div></div><div style="margin-top:20px"></div><span id="sec4.6"></span><h2 id="0ab99069-0424-4ec8-a0ba-5a8067629c6e">4.6 Application in machine learning and data science</h2><div style="margin-top:20px"></div>To start with, consider a toy example of a machine learning problem: we wish
to tell the gender of a person based on a data point consisting of
the height and weight of the person.<div style="margin-top:20px"></div>To do this we train our model by measuring the height and weight of a
lot of people. Each of these measured data points are labeled
female or male according to the gender of the person.<div style="margin-top:20px"></div><div class="centerimg"><img src="img/sephp.png" ></div><div style="margin-top:20px"></div>Given a new data point, we wish to tell if the person is female or male. Here we
consider a very simple model for doing this. First we need to introduce some
new mathematical terms. We will introduce the terms generally for
data points in <span class="math"></span><script type="math/tex">\mathbb{R}^d</script> and not just in <span class="math"></span><script type="math/tex">\mathbb{R}^2</script> as above.<div style="margin-top:20px"></div>A hyperplane in <span class="math"></span><script type="math/tex">\mathbb{R}^d</script> is a generalization of a line <span class="math"></span><script type="math/tex">y = a x + b</script> in the plane. In general
a hyperplane is defined as the set of points <span class="math"></span><script type="math/tex">x\in \mathbb{R}^d</script> satisfying
<div class="math"></div><script type="math/tex; mode=display">
a^T x = b,
</script>
where <span class="math"></span><script type="math/tex">a\in \mathbb{R}^d</script> is a non-zero vector and <span class="math"></span><script type="math/tex">b</script> is a number. A hyperplane divides <span class="math"></span><script type="math/tex">\mathbb{R}^d</script>
into two subsets: the points above or on the hyperplane satisfying <span class="math"></span><script type="math/tex">a^T x \geq b</script> and the ones
below the hyperplane satisfying <span class="math"></span><script type="math/tex">a^T x < b</script>.<div style="margin-top:20px"></div>Suppose we are given a data set as a finite set of points in <span class="math"></span><script type="math/tex">\mathbb{R}^d</script> and that each of
these points are labeled with either a blue or a red color. We wish to
find a hyperplane, such that the blue points are above and the red points
are below the hyperplane.<div style="margin-top:20px"></div><div class="centerimg"><img src="img/sephpWithline.png" ></div><div style="margin-top:20px"></div>We may then use the hyperplane to predict the label of a point. This could be
gender, if you win or lose money buying a stock, anything with
a binary classifier.<div style="margin-top:20px"></div><span id="sec4.6.1"></span><h3>4.6.1 Formulation as a linear optimization problem</h3><div style="margin-top:20px"></div>Suppose that the points labeled blue are <span class="math"></span><script type="math/tex">x_1, \dots, x_m\in \mathbb{R}^d</script> and
  the points labeled red are <span class="math"></span><script type="math/tex">y_1, \dots, y_n\in \mathbb{R}^d</script>. Then we wish to
  find <span class="math"></span><script type="math/tex">a\in \mathbb{R}^d</script> and <span class="math"></span><script type="math/tex">b\in \mathbb{R}</script>, such that
  <div class="math"></div><script type="math/tex; mode=display">
  a^T x_i > b
  </script>
  for <span class="math"></span><script type="math/tex">i = 1, \dots, m</script> and
  <div class="math"></div><script type="math/tex; mode=display">
  a^T y_j < b
  </script>
  for <span class="math"></span><script type="math/tex">j = 1, \dots, n</script>. One can show that these strict inequalities may be solved 
  for <span class="math"></span><script type="math/tex">a</script> and <span class="math"></span><script type="math/tex">b</script> if and only if the inequalities
  <div class="math"></div><script type="math/tex; mode=display">\begin{aligned}
  a^T x_i &\geq b + 1\\
  a^T y_j &\leq b - 1
  \end{aligned}</script>
  are solvable for <span class="math"></span><script type="math/tex">a</script> and <span class="math"></span><script type="math/tex">b</script>, where <span class="math"></span><script type="math/tex">i = 1, \dots, m</script> and <span class="math"></span><script type="math/tex">j = 1, \dots, n</script>.<div style="margin-top:20px"></div>It is, however, not realistic to expect data to behave this nicely. Instead one invents
  the rather ingenious linear optimization problem<div style="margin-top:20px"></div><span id="equ4.7"></span><div class="math"></div><script type="math/tex; mode=display">\begin{aligned}
    &\text{Minimize} &\frac{1}{m}(u_1 + \cdots + u_m) + \frac{1}{n}(v_1 + \cdots + v_n)\\
    &\text{with constraints}\\
    &&a^T x_i + u_i&\geq b + 1\\
    &&a^T y_j - v_j &\leq b - 1\\
    &&u_i&\geq 0\\
    &&v_j&\geq 0
  \end{aligned}\tag{4.7}</script><div style="margin-top:20px"></div>for <span class="math"></span><script type="math/tex">i = 1, \dots, m</script> and <span class="math"></span><script type="math/tex">j = 1, \dots, n</script>. This linear optimization problem has optimal value zero
  if and only if data can be separated strictly. Otherwise, it finds a hyperplane minimizing the mean errors
  for the points involved.<div style="margin-top:20px"></div>The linear optimization problem <a href=#equ4.7>(4.7)</a> may look untied to the real world, but it has
  been used very successfully in the diagnosis and prognosis of breast
  cancer. See <a href="https://www.jstor.org/stable/171686" target="_blank">Mangasarian et al.</a><div style="margin-top:20px"></div>In the sage window below we have implemented the solution of the
  linear optimization problem <a href=#equ4.7>(4.7)</a>, where the output is
  a graphical illustration of the optimal line, that separates the
  points in <tt>xpts</tt> and <tt>ypts</tt> with the smallest mean
  error as defined in the function to be minimized in <a href=#equ4.7>(4.7)</a>.<div style="margin-top:20px"></div><div class="sage"><script type="text/x-sage">
# Enter blue data points below
xpts = [(3, 1), (4, 2), (4, 3), (3, 5)]
# Enter red data points below
ypts = [(2, 2), (2.5, 4.5), (3, 2), (4, 1)]

LP = MixedIntegerLinearProgram(solver = "GLPK", maximization=False)

# generate variables (do not require integer solution) 
a = LP.new_variable(integer=False)
b = LP.new_variable(integer=False)
u = LP.new_variable(integer=False, nonnegative=True)
v = LP.new_variable(integer=False, nonnegative=True)

# Linear function to be minimized

LP.set_objective(float(1)/len(xpts)*sum(u[i] for i in range(1, len(xpts)+1)) + float(1)/len(ypts)*sum(v[i] for i in range(1, len(ypts)+1)))

# Add constraints

for i in range(1, len(xpts)+1):
  LP.add_constraint(xpts[i-1][0]*a[1] + xpts[i-1][1]*a[2] + u[i] >= b[1] + 1)

for j in range(1, len(ypts)+1):
  LP.add_constraint(ypts[j-1][0]*a[1] + ypts[j-1][1]*a[2] - v[j] <= b[1] - 1)

# LP.show()

oval = LP.solve()
aopt = LP.get_values(a);
bopt = LP.get_values(b)

# Compute frame for showing separating line

pts = xpts + ypts
xvals = list(map(lambda x: x[0], pts))
yvals = list(map(lambda y: y[1], pts))

xmin = min(xvals)
xmax = max(xvals)
ymin = min(yvals)
ymax = max(yvals)

# Intersection of separating line with frame (cumbersome!):

if (aopt[2] == 0):
  x =  bopt[1]/aopt[1]
  p1 = (x, ymin)
  p2 = (x, ymax)
else:
  a = -aopt[1]/aopt[2]
  b = bopt[1]/aopt[2]
  y = a*xmin + b
  if (y >= ymin and y <= ymax):
    p1 = (xmin, y)
    x = (ymax - b)/a
    if (x > xmin and x <= xmax):
      p2 = (x, ymax)
    else:
      x = (ymin - b)/a  
      if (x >= xmin and x <= xmax):
        p2 = (x, ymin)
      else:
        p2 = (xmax, a*xmax+b)
  else:
    x = (ymax - b)/a
    if (x >= xmin and x <= xmax):
      p1 = (x, ymax)
      y = a*xmax + b
      if (y >= ymin and y < ymax):
        p2 = (xmax, y)
      else:
        x = (ymin -b)/a
        p2 = (x, ymin)
    else:
      p1 = (xmax, a*xmax + b)
      x = (ymin - b)/a
      p2 = (x, ymin)

show(points(xpts, rgbcolor=(0, 0, 1), pointsize=30) + points(ypts, rgbcolor=(1,0,0), pointsize=30) + line([p1, p2], rgbcolor=(100, 100, 100), linestyle='dashed')) 
</script></div><div style="margin-top:20px"></div></div></body><div style="margin-top:20px"></div>